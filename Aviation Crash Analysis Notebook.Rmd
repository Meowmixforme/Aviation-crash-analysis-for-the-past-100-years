---
title: "Aviation Crash Analysis"
output: html_notebook
---

# Work in progress/ very messy/ needs sorting through and cleaning up as I complete parts

# Import data

```{r}
#install.packages("readr")
library(readr)
library(lubridate)

aero <- read.csv("Airplane_Crashes_and_Fatalities_Since_1908.csv")

```

# check data format

```{r}
str(aero)

```

Date needs to be changed
Time can be set into am/pm (time of day range) or other factor
all others except summary can be made into factors

```{r}
str(aero$Date)
str(aero$Time)
str(aero$Location)
str(aero$Operator)
str(aero$Route)
str(aero$type)
str(aero$Registration)
str(aero$cn.In)
str(aero$Aboard)
str(aero$Fatalities)
str(aero$Ground)
str(aero$Summary)

```

```{r}
# Changing all char to factors
aero[sapply(aero, is.character)] <- lapply(aero[sapply(aero, is.character)], as.factor)

# Convert the Time column to POSIXct
#aero$Time <- strptime(aero$Time, format = "%H:%M")

# Extract hours and minutes as numeric
#aero$Time_numeric <- aero$Time$hour * 100 + aero$Time$min
```



# Changing data types from Char and converting empty strings and dashes to NA

```{r}
# lubridate testing code (something to consider)

#aero$Date <- as.Date(aero$Date, format="%m/%d/%Y") # Change Date from a char to Date data type
#aero$Time <- lubridate::hm(aero$Time) # Change from char to lubridate

# Changing missing spaces and dashes into NA

aero$Location <- ifelse(aero$Location == "", NA, aero$Location)
aero$Operator <- ifelse(aero$Operator == "", NA, aero$Operator)
aero$Flight.. <- ifelse(aero$Flight.. == "", NA, aero$Flight..)
aero$Flight.. <- ifelse(aero$Flight.. == "-", NA, aero$Flight..)
aero$Route <- ifelse(aero$Route == "", NA, aero$Route)
aero$Type <- ifelse(aero$Type == "", NA, aero$Type)
aero$Registration <- ifelse(aero$Registration == "", NA, aero$Registration)
aero$cn.In <- ifelse(aero$cn.In == "", NA, aero$cn.In)
aero$Summary <- ifelse(aero$Summary == "", NA, aero$Summary)

```

# Percentage of missing values in each column

```{r}
#aero$Date[aero$Date == ""] <- NA # Fill in empty string with NA
#aero$Date[aero$Date == ""] <- NA # Fill in empty string with NA



#print(aero$Date)
#print(aero$Time)

misscol <- colSums(is.na(aero)) / nrow(aero)
round(misscol, 3)
```

Fatalities has very few and can be quickly fixed first

```{r}
na_count1 <- sum(is.na(aero$Date))
na_count2 <- sum(is.na(aero$Time))
na_count3 <- sum(is.na(aero$Operator))
na_count4 <- sum(is.na(aero$Flight..))
na_count5 <- sum(is.na(aero$Route))
na_count6 <- sum(is.na(aero$Type))
na_count7 <- sum(is.na(aero$Registration))
na_count8 <- sum(is.na(aero$cn.In))
na_count9 <- sum(is.na(aero$Aboard))
na_count10 <- sum(is.na(aero$Fatalities))
na_count11 <- sum(is.na(aero$Ground))
na_count12 <- sum(is.na(aero$Summary))



na_count1
na_count2
na_count3
na_count4
na_count5
na_count6
na_count7
na_count8
na_count9
na_count10
na_count11
na_count12
```
# Search for most frequent words in Summary (Text Mining)

```{r}
library(tidytext)
library(dplyr)

aero <- as_tibble(aero)

# Tokenize and count words
word_counts <- aero %>%
  unnest_tokens(word, Summary) %>%  # This function splits the text into individual words.
  count(word, sort = TRUE)          # Count occurrences of each word

print(word_counts)
```

I'll need to get a list of words such as pilot = human error / engine = mechanical failure / thunderstorm/fog/weather = weather. Landing vs takeoff etc. Then make new columns with this extracted data.


```{r}
# need to sort out NA and make new columns from filtered words
```

```{r}
#cor(aero[sapply(aero, is.numeric)])

numeric_columns <- aero[sapply(aero, is.numeric)]
cor_matrix <- cor(numeric_columns, use = "complete.obs")
cor_matrix
```
Some quite obvious correlations (location/route) I'll need to clean the data up and try this properly later


```{r}
plot(aero)
```
Just a reminder that I'll need to visualise the data


Step 1 is dealing with missing data